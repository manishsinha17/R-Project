training_x1 <- training[[2]]  # by column number
training_x2 <- training[[3]]  # by column number
training_x3 <- training[[4]]  # by column number
training_x4 <- training[[5]]  # by column number
training_x5 <- training[[6]]  # by column number
training_x6 <- training[[7]]  # by column number
training_x7 <- training[[8]]  # by column number
training_x8 <- training[[9]]  # by column number
training_x9 <- training[[10]]  # by column number
training_x10 <- training[[11]]  # by column number
beta_result = gradiant_derivative(.01, .0001, 1 , training_x1, training_x2, training_x3, training_x4, training_x5, training_x6
, training_x7, training_x8, training_x9, training_x10, training_y)
print(beta_result)
avg_prediction_error<- function(beta, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, y) {
exponent_term = exp(beta[1] + beta[2]*x1 + beta[3]*x2 + beta[4]*x3+ beta[5]*x4 + beta[6]*x5 + beta[7]*x6 + beta[8]*x7
+ beta[9]*x8 + beta[10]*x9 + beta[11]*x10)
e2 <- matrix(c(0,0,0,0,0,0,0,0,0,0,0))
p <- matrix(c(0,0,0,0,0,0,0,0,0,0,0))
p = exponent_term/(1 +exponent_term)
#print(p)
e2 = (y-p)^2
print(e2)
mean(e2)
}
testing_y <- testing[[1]]  # by column number
testing_x1 <- testing[[2]]  # by column number
testing_x2 <- testing[[3]]  # by column number
testing_x3 <- testing[[4]]  # by column number
testing_x4 <- testing[[5]]  # by column number
testing_x5 <- testing[[6]]  # by column number
testing_x6 <- testing[[7]]  # by column number
testing_x7 <- testing[[8]]  # by column number
testing_x8 <- testing[[9]]  # by column number
testing_x9 <- testing[[10]]  # by column number
testing_x10 <- testing[[11]]  # by column number
avg_prediction_error(beta_result, testing_x1, testing_x2, testing_x3, testing_x4, testing_x5, testing_x6, testing_x7
, testing_x8, testing_x9, testing_x10, testing_y)
avg_prediction_error(beta_result, testing_x1, testing_x2, testing_x3, testing_x4, testing_x5, testing_x6, testing_x7
, testing_x8, testing_x9, testing_x10, testing_y)
library(splines)
library(ISLR)
attach(wage)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age.grid),se=T)
pred = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
print(pred)
print(pred$fit)
print(pred$fit)
print(pred$pse.fit)
print(pred$se.fit)
print(pred$fit)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred = predict(fit2,newdata=list(age=30),se=T)
plot(age,wage, col="darkgrey")
print(pred$fit2)
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
lines(age, pred$fit,lwd=2)
pred = predict(fit,newdata=list(age=age.grid),se=T)
lines(age.grid, pred$fit,lwd=2)
lines(age, pred$fit,lwd=2)
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age),se=T)
plot(age,wage, col="grey")
lines(age, pred$fit,lwd=2)
print(pred$fit)
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age),se=T)
pred.30 = predict(fit,newdata=list(age=age),se=T)
print(pred.30$fit)
pred.30 = predict(fit,newdata=list(age=30),se=T)
print(pred.30$fit)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2 = predict(fit2,newdata=list(age=age),se=T)
pred2.30 = predict(fit2,newdata=list(age=30),se=T)
plot(age,wage, col="darkgrey")
lines(age, pred2$fit,lwd=2)
print(pred2.30$fit2)
print(pred2$fit2)
print(pred2)
print(pred2$x=30)
print(pred2[30])
print(pred2$y)
print(pred2$y[30])
print(pred$fit[30])
print(pred$fit)
print(pred$fit[30])
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age),se=T)
plot(age,wage, col="grey")
lines(age, pred$fit,lwd=2)
print(pred$fit[30])
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age),se=T)
plot(age,wage, col="grey")
lines(age, pred$fit,lwd=2)
print(pred$fit[30])
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2 = predict(fit2,newdata=list(age=age),se=T)
plot(age,wage, col="darkgrey")
lines(age, pred2$fit,lwd=2)
print(pred2$y[30])
print(pred$fit[30])
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
plot.gam(gam1, se=TRUE, col="red")
plot(gam1, se=TRUE, col="red")
print(pred2)
print(pred2$y[30])
plot(gam1, se=TRUE, col="red")
warnings()
print(pred$fit[30])
print(pred2$y[30])
print(pred2$y[30])
print(pred3)
pred3 = predict(gam1,newdata=list(age=age),se=T)
print(pred3)
print(pred3$fit[30])
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
pred3 = predict(gam1,newdata=list(age=age),se=T)
plot(gam1, se=TRUE, col="red")
plot(gam1, se=TRUE, col="red")
library(ISLR)
library(splines)
library(gam)
attach(Wage)
age.grid<-seq(from=agelims[1], to = agelims[2])
model= lm(wage~bs(age, knots=c(30,50,60)), data = Wage)
plot(age,wage,col="grey",xlab="Age",ylab="Wages")
points(age.grid,predict(model,newdata = list(age=age.grid)),col="darkgreen",lwd=2,type="l")
abline(v=c(30,50,60),lty=2,col="blue")
predict_cubic_spline = predict(model, data.frame(age = 30))
predict_cubic_spline
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age),se=T)
pred1.1 = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
print(pred1.1)
print(pred1.1$fit)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2 = predict(fit2,newdata=list(age=age),se=T)
pred2.1 = predict(fit2,newdata=list(age=age),se=T)
plot(age,wage, col="darkgrey")
print(pred2.1)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2 = predict(fit2,newdata=list(age=age),se=T)
pred2.1 = predict(fit2,newdata=list(age=30),se=T)
plot(age,wage, col="darkgrey")
print(pred2.1)
library(ISLR)
library(splines)
library(gam)
data <- Wage
plot(data$age ,data$wage,cex =.5,col=" darkgrey ")
model_2=smooth.spline(data$age,data$wage,cv=TRUE)
lines(model_2 ,col="blue",lwd=2)
predict_smooth = predict(model_2, data.frame(age = 30))
predict_smooth
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2 = predict(fit2,newdata=list(age=age),se=T)
pred2.1 = predict(fit2,newdata=data.frame(age = 30),se=T)
plot(age,wage, col="darkgrey")
print(pred2.1)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2 = predict(fit2,newdata=list(age=age),se=T)
pred2.1 = predict(fit2,newdata=data.frame(age = 30))
plot(age,wage, col="darkgrey")
print(pred2.1)
pred2.1
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,newdata=data.frame(age = 30))
plot(age,wage, col="darkgrey")
pred2.1
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,data.frame(age = 30))
pred2.1
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,newdata=data.frame(age = 30))
pred2.1
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,data.frame(age = 30))
plot(age,wage, col="darkgrey")
pred2.1
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred = predict(fit,newdata=list(age=age),se=T)
pred1.1 = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
print(pred1.1$fit)
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
print(pred1.1$fit)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,list(age = 30))
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,newdata=list(age = 30))
pred2.1
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,(age = 30))
plot(age,wage, col="darkgrey")
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,newdata=list(age=30),se=T)
plot(age,wage, col="darkgrey")
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,Wage.frame(age=30),se=T)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,data.frame(age=30),se=T)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,data.frame(age=30))
library(ISLR)
library(splines)
library(gam)
data <- Wage
plot(data$age ,data$wage,cex =.5,col=" darkgrey ")
model_2=smooth.spline(data$age,data$wage,cv=TRUE)
lines(model_2 ,col="blue",lwd=2)
predict_smooth = predict(model_2, newdata=data.frame(age = 30))
predict_smooth
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,newdata=data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,newdata=list(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,newdata=data.frame(age=30),se=T)
plot(age,wage, col="grey")
print(pred1.1$fit)
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(ISLR)
library(splines)
library(gam)
attach(Wage)
age.grid<-seq(from=agelims[1], to = agelims[2])
model= lm(wage~bs(age, knots=c(30,50,60)), data = Wage)
plot(age,wage,col="grey",xlab="Age",ylab="Wages")
points(age.grid,predict(model,newdata = list(age=age.grid)),col="darkgreen",lwd=2,type="l")
abline(v=c(30,50,60),lty=2,col="blue")
predict_cubic_spline = predict(model, data.frame(age = 30))
predict_cubic_spline
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,newdata=data.frame(age=30),se=T)
print(pred1.1$fit)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
print(pred1.1$fit)
library(splines)
library(ISLR)
attach(Wage)
fit2 = smooth.spline(age,wage,cv=TRUE)
pred2.1 = predict(fit2,data.frame(age=30))
plot(age,wage, col="darkgrey")
pred2.1
library(ISLR)
library(splines)
library(gam)
attach(Wage)
model_3=lm(wage~ns(age,df=4)+maritl ,data = Wage)
par(mfrow=c(1,3)) #to partition the Plotting Window
plot.Gam(model_3, se=TRUE, col="red")
predict_GAM = predict(model_3, data.frame(age = 30, maritl='2. Married'))
predict_GAM
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
pred3 = predict(gam1,data.frame(age = 30, maritl='2. Married'),se=T)
print(pred3)
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
pred3 = predict(gam1,data.frame(age = 30, maritl='2. Married'),se=T)
print(pred3$fit)
plot.Gam(gam1, se=TRUE, col="red")
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
pred3 = predict(gam1,data.frame(age = 30, maritl='2. Married'),se=T)
print(pred3$fit)
plot.Gam(gam1, se=TRUE, col="red")
plot.Gam(model_3, se=TRUE, col="red")
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
pred3 = predict(gam1,data.frame(age = 30, maritl='2. Married'),se=T)
print(pred3$fit)
par(mfrow=c(1,3)) #to partition the Plotting Window
plot.Gam(gam1, se=TRUE, col="red")
library(splines)
library(ISLR)
attach(Wage)
gam1 = lm(wage~ns(age,4) + maritl, data=Wage)
pred3 = predict(gam1,data.frame(age = 30, maritl='2. Married'),se=T)
print(pred3$fit)
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
print(pred1.1$fit)
plot(age,wage, col="grey")
library(ISLR)
library(splines)
library(gam)
attach(Wage)
age.grid<-seq(from=agelims[1], to = agelims[2])
model= lm(wage~bs(age, knots=c(30,50,60)), data = Wage)
plot(age,wage,col="grey",xlab="Age",ylab="Wages")
points(age.grid,predict(model,newdata = list(age=age.grid)),col="darkgreen",lwd=2,type="l")
abline(v=c(30,50,60),lty=2,col="blue")
predict_cubic_spline = predict(model, data.frame(age = 30))
predict_cubic_spline
plot(age,wage,col="grey",xlab="Age",ylab="Wages")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(age=30),se=T)
plot(age,wage, col="grey")
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(Wage$age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(Wage$age=30),se=T)
attach(Wage)
library(splines)
library(ISLR)
fit = lm(wage~bs(Wage$age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(Wage$age=30),se=T)
library(ISLR)
library(splines)
library(gam)
attach(Wage)
age.grid<-seq(from=agelims[1], to = agelims[2])
model= lm(wage~bs(age, knots=c(30,50,60)), data = Wage)
plot(age,wage,col="grey",xlab="Age",ylab="Wages")
points(age.grid,predict(model,newdata = list(age=age.grid)),col="darkgreen",lwd=2,type="l")
abline(v=c(30,50,60),lty=2,col="blue")
predict_cubic_spline = predict(model, data.frame(age = 30))
predict_cubic_spline
library(splines)
library(ISLR)
attach(Wage)
fit = lm(wage~bs(Wage$age,knots=c(30,50,60)), data=Wage)
pred1.1 = predict(fit,data.frame(Wage$age=30),se=T)
library(ISLR)
library(splines)
library(gam)
attach(Wage)
model= lm(wage~bs(age, knots=c(30,50,60)), data = Wage)
plot(age,wage,col="grey",xlab="Age",ylab="Wages")
plot(Wage$age,Wage$wage, col="grey")
plot(Wage$age,Wage$wage,col="grey",xlab="Age",ylab="Wages")
plot(Wage$age,Wage$wage, col="grey")
abline(v=c(30,50,60),lty=2,col="blue")
predict_cubic_spline = predict(model, data.frame(age = 30))
predict_cubic_spline
library(ISLR)
library(splines)
library(gam)
data <- Wage
plot(data$age ,data$wage,cex =.5,col=" darkgrey ")
model_2=smooth.spline(data$age,data$wage,cv=TRUE)
lines(model_2 ,col="blue",lwd=2)
predict_smooth = predict(model_2, data.frame(age = 30))
predict_smooth
predict_smooth$y
library(ISLR)
library(splines)
library(gam)
attach(Wage)
model_3=lm(wage~ns(age,df=4)+maritl ,data = Wage)
par(mfrow=c(1,3))
plot.Gam(model_3, se=TRUE, col="red")
predict_GAM = predict(model_3, data.frame(age = 30, maritl='2. Married'))
predict_GAM
